package testutils

type TestCase struct {
	Name           string
	BlockInfo      []string
	ExpectedResult ReorgTestResult
}

type ReorgTestResult struct {
	MustBeLive        bool
	StartBlock        uint64
	EndBlock          uint64
	Depth             int
	NumBlocks         int
	NumReplacedBlocks int
}

/*
Interesting reorgs for tests:

2021/08/16 03:55:05 Reorg 13033424_13033425_d2_b5 (/server/geth.ipc): live=false  blocks 13033424 - 13033425, depth: 2, numBlocks: 5
- ChainSegment [orph], blocks: 2 - 0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461, 0x448b1495889c0a1759e83d08b5550b14c7992b6dd84b0eda84414bbd62675337
- ChainSegment [orph], blocks: 1 - 0x5c4aaa79df3c48f53282340c1893a4547d4d42c4ca3af5376dba34646832925d
- ChainSegment [orph], blocks: 1 - 0xd608ccc185b058eae7c12547712244c38ddd98e515e8ba1df7e0af29b468bd3c
- ChainSegment [main], blocks: 1 - 0x5996b0838dbd0d23458664633d1f7beef77be74a69abafdd588825b01ab1f15a
stateDiagram-v2
    0x29af3e566af450ec7443b1857944a7c266aed19707f348e24657bc4abc32ec9f --> 0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461
    0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461 --> 0x448b1495889c0a1759e83d08b5550b14c7992b6dd84b0eda84414bbd62675337
    0x29af3e566af450ec7443b1857944a7c266aed19707f348e24657bc4abc32ec9f --> 0x5c4aaa79df3c48f53282340c1893a4547d4d42c4ca3af5376dba34646832925d
    0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461 --> 0xd608ccc185b058eae7c12547712244c38ddd98e515e8ba1df7e0af29b468bd3c
    0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461 --> 0x5996b0838dbd0d23458664633d1f7beef77be74a69abafdd588825b01ab1f15a
    0x5996b0838dbd0d23458664633d1f7beef77be74a69abafdd588825b01ab1f15a --> 0xb63bb5b0ee3bffb39c6afec9e7569150c9a9b170aba84f5a34c960ffb27046e4
*/

var Test_Tmp = TestCase{
	Name:           "uncletest",
	BlockInfo:      []string{"13090277", "13090279"},
	ExpectedResult: ReorgTestResult{StartBlock: 13090277, EndBlock: 13090279, Depth: 1, NumBlocks: 3, NumReplacedBlocks: 2},
}

var Test_12996760_12996760_d1_b2 = TestCase{
	Name:           "1 uncle",
	BlockInfo:      []string{"12996760", "12996763"},
	ExpectedResult: ReorgTestResult{StartBlock: 12996760, EndBlock: 12996760, Depth: 1, NumBlocks: 2, NumReplacedBlocks: 1},
}

var Test_12996750_12996750_d1_b3_twouncles = TestCase{
	Name:           "2 uncles",
	BlockInfo:      []string{"12996749", "12996751"},
	ExpectedResult: ReorgTestResult{StartBlock: 12996750, EndBlock: 12996750, Depth: 1, NumBlocks: 3, NumReplacedBlocks: 2},
}

var Test_12991732_12991733_d2_b4 = TestCase{
	BlockInfo: []string{
		"12991730",
		"0xc5d7c2d6da0a4dba574ca6b7697b5850477d646fdb067b20d908060b0d5651c7", // 12991733
		"0x61d0546aba46a166c185c584673e5afe911673e22ca75a754f165454b161e72a", // 12991734
		"12991736",
	},
	ExpectedResult: ReorgTestResult{StartBlock: 12991732, EndBlock: 12991733, Depth: 2, NumBlocks: 4, NumReplacedBlocks: 2},
}

var Test_12969887_12969889_d3_b6 = TestCase{
	BlockInfo: []string{
		"12969885",
		"0xae396e35c045b8603de015e182ce1349c579c68bb00396bfb8a7b5946a4fa87c", // 12969889
		"0xdca194ddb314c1c4e3de10ccfcb88bf9183a78118a393e1b3860e5eb10dd7c6c", // 12969889
		"12969891",
	},
	ExpectedResult: ReorgTestResult{StartBlock: 12969887, EndBlock: 12969889, Depth: 3, NumBlocks: 6, NumReplacedBlocks: 3},
}

var Test_13017535_13017536_d2_b5 = TestCase{ // 3 blocks at 13017535, 2 blocks at 13017536
	BlockInfo: []string{
		"0xd633f8b768ae1e6975eb0fbd8f5d7ef7b06151a9106a23c17b0ee1b4f74a9bed", // 13017533
		"0xab672fe4e5ca25f44d8cf5c8be556a155d976ddc27a21e069172b3dda7335dad", // 13017534
		"0xd24bb816d9416fe504dea1d2480e560f31d59a50035cd967142cbb118782a015", // 13017535
		"0xfa5314344ed60908988e30524fbcdf4b1fef23a050339368c53c96c5461c956b", // 13017535
		"0x990e488c4eebcb83d17c739311b639c41c200c3906093b6d80ed10d2a75c503b", // 13017536
		"0xdc9a6e449e959ca888da7365d529ac9e05d98d9f7e88adc0e5016da13cef10b7", // 13017535
		"0x3e0e26323edfe6728a4ded45716c138b9e85df50342eea4059f2354ac2937d08", // 13017536
		"0xebf21cef1a406e30bb7b4d482591ca82e444f779efcb76ce67d09c2f548b4c82", // 13017537
		"0xb22ff4c5759adb7e14da8644d2dfdef98bb0e43f3d548cdcdbb0c7fa78675413", // 13017538
	},
	ExpectedResult: ReorgTestResult{StartBlock: 13017535, EndBlock: 13017536, Depth: 2, NumBlocks: 5, NumReplacedBlocks: 3},
}

var Test_13018369_13018370_d2_b4 = TestCase{
	BlockInfo: []string{
		"0xae416859b2ae32ac70dee15d3b164d81f27c5990312b72419bd0d15c856911bc", // 13018368
		"0x9282169b84cde985685d6157438ef5a4ff7fa83a895ff31a4893c9400e87b0c9", // 13018369
		"0xd9fb42a0296ebb85924366ada87d5acf8eae2069c408111c52c585b48bbb0ec0", // 13018369
		"0xf06bf47c3332361f93cc24c45954949755fa4474631bdfeaa176b48929a56663", // 13018370
		"0x94e290ab3ddaea782b826ea66094c429db1aeb632f80fe7fd003faad9e0a2001", // 13018371
		"0x15d97a6e60b229e143e20bd1a810c3568f13b59a7c9a1f1098928e17389c355d", // 13018370
		"0x6a5706073f58b14949fbb47c9107c480fbb34f9b96c72b34385ae3d06de489b6", // 13018372
		"0x6b501f2591c5f16398497cf71ea7fcc845029847a39f90ebc01f76408a3c665f", // 13018373
		"0xcfba4b54e919631d3b678ab82c9f22bc0cfc4e26341825088a447830d46a7ba1", // 13018374
	},
	ExpectedResult: ReorgTestResult{StartBlock: 13018369, EndBlock: 13018370, Depth: 2, NumBlocks: 4, NumReplacedBlocks: 2},
}

var Test_13033424_13033425_d2_b5 = TestCase{
	BlockInfo: []string{
		"13033421",
		"0x29af3e566af450ec7443b1857944a7c266aed19707f348e24657bc4abc32ec9f", // 13033423, parent of reorg 1
		"0x42087d1b5230fd48172c19d301691aa0866d62739b00804e21ad9668a30fa461", // 13033424, reorg 1, child 1
		"0x5996b0838dbd0d23458664633d1f7beef77be74a69abafdd588825b01ab1f15a", // 13033424, reorg 1, child 2

		"0x448b1495889c0a1759e83d08b5550b14c7992b6dd84b0eda84414bbd62675337",
		"0x5c4aaa79df3c48f53282340c1893a4547d4d42c4ca3af5376dba34646832925d",
		"0xd608ccc185b058eae7c12547712244c38ddd98e515e8ba1df7e0af29b468bd3c",
		"0xb63bb5b0ee3bffb39c6afec9e7569150c9a9b170aba84f5a34c960ffb27046e4",
		// "13033428",
	},
	ExpectedResult: ReorgTestResult{StartBlock: 13033424, EndBlock: 13033425, Depth: 2, NumBlocks: 5, NumReplacedBlocks: 3},
}

var TestD1and2 = TestCase{
	// https://mermaid-js.github.io/mermaid-live-editor/view/#eyJjb2RlIjoic3RhdGVEaWFncmFtLXYyXG4gICAgMHhkMzE0NTMyNjgyZWM1Mjc3MzMxYjg1N2E2OGJmMjIwM2I1MjBhNGZkMWM4NWJlNzViMDMyOTY1OGYxOTY2YjAyIC0tPiAweDdkZTk2OWNkNGI4M2MwYTdmN2E0MjMxYmY2MDY0N2MyNDBiYzE2YTAxZmRmZGNhYjE1ZWU4Zjg3MjA1MDFjOTRcbiAgICAweGQzMTQ1MzI2ODJlYzUyNzczMzFiODU3YTY4YmYyMjAzYjUyMGE0ZmQxYzg1YmU3NWIwMzI5NjU4ZjE5NjZiMDIgLS0-IDB4MGFhMmMzYWI4MmQ4ODI3ZWUzYTIyNTIxZjQyNDE5NDFmYzdhZTAwZjVkZjk5NGNlNmY4OGZhZGQyNDRkZjQwYlxuICAgIDB4N2RlOTY5Y2Q0YjgzYzBhN2Y3YTQyMzFiZjYwNjQ3YzI0MGJjMTZhMDFmZGZkY2FiMTVlZThmODcyMDUwMWM5NCAtLT4gMHhhOTdjY2MwM2U4NmUzODVkYzRiOWJjMDNhZWU5OTc2YWQ5ODliYWZmMTExN2JhYmZhNDdhNWFlZjg3ZTg2ODAzXG4gICAgMHgwYWEyYzNhYjgyZDg4MjdlZTNhMjI1MjFmNDI0MTk0MWZjN2FlMDBmNWRmOTk0Y2U2Zjg4ZmFkZDI0NGRmNDBiIC0tPiAweGY5MTAxMzA0NDQ1YWViYzFkMmNlNmFlYzczNWM0YWU1OTY5Y2Q1YjQ1YmUxNzYzNzZiNjgwMmE2MTAwYjc1YzNcbiAgICAweGU2NWEwMTYzZWNkODI5YWVkODkwZWZkMDg4NWIwMGM3Yzg4NjEwZGVmYzFkYjZiNTU4NTRlYjc3M2RkOTg1N2UgLS0-IDB4ZDMxNDUzMjY4MmVjNTI3NzMzMWI4NTdhNjhiZjIyMDNiNTIwYTRmZDFjODViZTc1YjAzMjk2NThmMTk2NmIwMlxuICAgIDB4ZTY1YTAxNjNlY2Q4MjlhZWQ4OTBlZmQwODg1YjAwYzdjODg2MTBkZWZjMWRiNmI1NTg1NGViNzczZGQ5ODU3ZSAtLT4gMHhhODVmZjhlYzc2YWRjYWE4MGE0ZjhjNzkzMzUyYWYwNmY0M2ZjNWZlZTY3ZjE5NjFkOTkyODgyMjg0ODA3YzUxXG4gICAgMHhmOTEwMTMwNDQ0NWFlYmMxZDJjZTZhZWM3MzVjNGFlNTk2OWNkNWI0NWJlMTc2Mzc2YjY4MDJhNjEwMGI3NWMzIC0tPiAweGYzMGYwMjRkZjc5NzE0N2ZmNjFiMDZhNzRmMGM1NjllNzg0MGExYjRkOTc1ODMxNmUzOGJiYmQ5MDhiMzdlYjgiLCJtZXJtYWlkIjoie1xuICBcInRoZW1lXCI6IFwiZGVmYXVsdFwiXG59IiwidXBkYXRlRWRpdG9yIjp0cnVlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6dHJ1ZX0
	BlockInfo: []string{
		"0xe65a0163ecd829aed890efd0885b00c7c88610defc1db6b55854eb773dd9857e",
		"0xd314532682ec5277331b857a68bf2203b520a4fd1c85be75b0329658f1966b02",
		"0xa85ff8ec76adcaa80a4f8c793352af06f43fc5fee67f1961d992882284807c51",
		"0xa97ccc03e86e385dc4b9bc03aee9976ad989baff1117babfa47a5aef87e86803",
		"0xf30f024df797147ff61b06a74f0c569e7840a1b4d9758316e38bbbd908b37eb8",
	},
}

var Test3xD1 = TestCase{
	// https://mermaid-js.github.io/mermaid-live-editor/view/#eyJjb2RlIjoic3RhdGVEaWFncmFtLXYyXG4gICAgMHgwOGYxM2JjNzRkMDQwYzA5ZjAxNmY0ZDZjNzJlMThlZTc5NzJiYTQyMmViNTg5MmNjMDhkYjc3YmM0OGQ0MjRlIC0tPiAweDk2MTU1YmNiZjBjZjcyMWRkZWJhOWQxYzA0YWJmOGZhY2ZkODFjODQyN2EzZjI3Y2Q5MzU1Y2NkODRmYTg2MWVcbiAgICAweDA4ZjEzYmM3NGQwNDBjMDlmMDE2ZjRkNmM3MmUxOGVlNzk3MmJhNDIyZWI1ODkyY2MwOGRiNzdiYzQ4ZDQyNGUgLS0-IDB4YmNhYTNhY2JlOGQ3NTMwNWRlNTBlZDM5NGVmOTIzYzVlNDVmMDYyOGYyMzJmYWE4YjA5YmIzMjdjN2ZhZGI5ZVxuICAgIDB4OTYxNTViY2JmMGNmNzIxZGRlYmE5ZDFjMDRhYmY4ZmFjZmQ4MWM4NDI3YTNmMjdjZDkzNTVjY2Q4NGZhODYxZSAtLT4gMHhjMDc1MWIyNGRkZTU3MzU1ZDAyY2VhY2YzNmJjNWYwZTM3MzY3ZDkxOTA3ODUwYzQzYTc0NzNmNjcwMWZjZmUxXG4gICAgMHg5NjE1NWJjYmYwY2Y3MjFkZGViYTlkMWMwNGFiZjhmYWNmZDgxYzg0MjdhM2YyN2NkOTM1NWNjZDg0ZmE4NjFlIC0tPiAweGU0YmZlMmYyNWNkZjM4YzZmNDE0YWY2ZDgxMTFlYjUzNDJiYjk2YmY3NDhiM2RkMGJiYTU4OWJlYzhkNGJjZmVcbiAgICAweGMwNzUxYjI0ZGRlNTczNTVkMDJjZWFjZjM2YmM1ZjBlMzczNjdkOTE5MDc4NTBjNDNhNzQ3M2Y2NzAxZmNmZTEgLS0-IDB4NGViYjY4MDQwMTM1ZjNlNmZkNTg3ZmM1N2U3ZDUxZjEwNzBkNWU4YzgzMGZlODk3OTkxMWM2MTQ3NDEzMDJhZFxuICAgIDB4YzA3NTFiMjRkZGU1NzM1NWQwMmNlYWNmMzZiYzVmMGUzNzM2N2Q5MTkwNzg1MGM0M2E3NDczZjY3MDFmY2ZlMSAtLT4gMHg5NDMyMTk5ZWIxMjYwMTk0NTI4ZmM1MmY0ZGQ5MWUzNTUwOTMwODY2ZmU4NzA0Y2ViY2MyNzhlM2UzOTUzMjRmXG4gICAgMHg0ZWJiNjgwNDAxMzVmM2U2ZmQ1ODdmYzU3ZTdkNTFmMTA3MGQ1ZThjODMwZmU4OTc5OTExYzYxNDc0MTMwMmFkIC0tPiAweDExMzY3MGIyYWNlY2M0Y2FmNjhkOWEzNWFhZDEwNmM2NjA1NzliM2U5YmNmODRlZjEwNjJkYWZlMWVjZTA4YmEiLCJtZXJtYWlkIjoie1xuICBcInRoZW1lXCI6IFwiZGVmYXVsdFwiXG59IiwidXBkYXRlRWRpdG9yIjp0cnVlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6dHJ1ZX0
	BlockInfo: []string{
		"0x08f13bc74d040c09f016f4d6c72e18ee7972ba422eb5892cc08db77bc48d424e",
		"0x113670b2acecc4caf68d9a35aad106c660579b3e9bcf84ef1062dafe1ece08ba",
		"0x9432199eb1260194528fc52f4dd91e3550930866fe8704cebcc278e3e395324f",
		"0xe4bfe2f25cdf38c6f414af6d8111eb5342bb96bf748b3dd0bba589bec8d4bcfe",
		"0xbcaa3acbe8d75305de50ed394ef923c5e45f0628f232faa8b09bb327c7fadb9e",
	},
}

var TestD3 = TestCase{
	// https://mermaid-js.github.io/mermaid-live-editor/view/#eyJjb2RlIjoic3RhdGVEaWFncmFtLXYyIDB4ZDY5MGE5YmIyNmQyN2Q2NjU3NjhmNjdiODgzOWVhNjU3MWExZTEwYzk1YWQ2OWUzOGRhYzE2ZDk2ODZmNWQ5ZiAtLT4gMHgzY2QyMzZlMTc4ZmM4M2ZlNzNiNTdjZGI3ODAyMTg3ZTFkNWIzYWNlYTJjMWQ0MDYxYzA5NmUyYjY4ODYzMzBkIDB4ZDY5MGE5YmIyNmQyN2Q2NjU3NjhmNjdiODgzOWVhNjU3MWExZTEwYzk1YWQ2OWUzOGRhYzE2ZDk2ODZmNWQ5ZiAtLT4gMHhmNTA0MjY0ZWUyZTllNjQ3MGY1ZTYwMjY2MzA0N2EzYTJmNDU0MWJjYzNmNDZjODVmZTBkZGFhMmZmNTZkZDIwIDB4ZjUwNDI2NGVlMmU5ZTY0NzBmNWU2MDI2NjMwNDdhM2EyZjQ1NDFiY2MzZjQ2Yzg1ZmUwZGRhYTJmZjU2ZGQyMCAtLT4gMHgyYTg0YmQ1MTIzOWVkMzZmMGU5YjczZmI1NDJkNzVlMzI2YTBhMGFjYTQ3ZDJjY2U4OGQ5NzI2OTZhZGVhYTIwIDB4M2NkMjM2ZTE3OGZjODNmZTczYjU3Y2RiNzgwMjE4N2UxZDViM2FjZWEyYzFkNDA2MWMwOTZlMmI2ODg2MzMwZCAtLT4gMHg5OTAxMWJiYzk1OWJmZTIzYjEzZTNiMzMwYmM0YTRkMjNmNmVjODEzOWUyMzQ2MGM1M2UzYTkxZjdiYTFmZWY1IDB4OTkwMTFiYmM5NTliZmUyM2IxM2UzYjMzMGJjNGE0ZDIzZjZlYzgxMzllMjM0NjBjNTNlM2E5MWY3YmExZmVmNSAtLT4gMHhjMjQzMjMzMTVmMzczNTAxNzAyNmY3NTRiM2Y2ZWUxYmNhM2NkYmI4ZTNmNmIyNDc2ZGQwOWFlYzRlNDBjYjM4IDB4MmE4NGJkNTEyMzllZDM2ZjBlOWI3M2ZiNTQyZDc1ZTMyNmEwYTBhY2E0N2QyY2NlODhkOTcyNjk2YWRlYWEyMCAtLT4gMHgwZjk3ZGY5NTU2NzJmODA3MjEyNGE3OTU5MDNkOGMyOTA0ODA2ZmJmM2JjZGRjMmU5ZjgyMjFkNDNjNjYyZDA2IDB4MGY5N2RmOTU1NjcyZjgwNzIxMjRhNzk1OTAzZDhjMjkwNDgwNmZiZjNiY2RkYzJlOWY4MjIxZDQzYzY2MmQwNiAtLT4gMHgxZWJhMWQ2MjcxMmI0MzA2N2NiOGY5MTNlNjgyMTkwZWFiZjJkZDAyMGE0ZTk1NGZkZDQ0NjBhNjA5OWYwOWE3XG5cbiIsIm1lcm1haWQiOiJ7XG4gIFwidGhlbWVcIjogXCJkZWZhdWx0XCJcbn0iLCJ1cGRhdGVFZGl0b3IiOnRydWUsImF1dG9TeW5jIjp0cnVlLCJ1cGRhdGVEaWFncmFtIjp0cnVlfQ
	BlockInfo: []string{
		"0xd690a9bb26d27d665768f67b8839ea6571a1e10c95ad69e38dac16d9686f5d9f",
		"0xc24323315f3735017026f754b3f6ee1bca3cdbb8e3f6b2476dd09aec4e40cb38",
		"0x1eba1d62712b43067cb8f913e682190eabf2dd020a4e954fdd4460a6099f09a7",
	},
}

var TestX = TestCase{
	BlockInfo: []string{
		"13123066",
		"13123067",
		"13123068",
		"13123069",
		"13123070",
	},
}
